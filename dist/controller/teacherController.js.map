{"version":3,"sources":["teacherController.js"],"names":["Object","defineProperty","exports","value","_mongoose","require","_mongoose2","_interopRequireDefault","_express","_schoolModel","_schoolModel2","_classroomModel","_classroomModel2","_teacherModel","_teacherModel2","_studentModel","_studentModel2","obj","__esModule","default","_ref","config","db","api","Router","post","req","res","findById","params","id","err","school","send","newTeacher","firstName","body","lastName","hub","_id","save","teacher","teachers","push","json","message","get","find","put","undefined","delete","classrooms","classroom","pull","remove"],"mappings":"AAAA;;AAEAA,OAAOC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AACzCC,WAAO;AADkC,CAA7C;;AAIA,IAAIC,YAAYC,QAAQ,UAAR,CAAhB;;AAEA,IAAIC,aAAaC,uBAAuBH,SAAvB,CAAjB;;AAEA,IAAII,WAAWH,QAAQ,SAAR,CAAf;;AAEA,IAAII,eAAeJ,QAAQ,sBAAR,CAAnB;;AAEA,IAAIK,gBAAgBH,uBAAuBE,YAAvB,CAApB;;AAEA,IAAIE,kBAAkBN,QAAQ,yBAAR,CAAtB;;AAEA,IAAIO,mBAAmBL,uBAAuBI,eAAvB,CAAvB;;AAEA,IAAIE,gBAAgBR,QAAQ,uBAAR,CAApB;;AAEA,IAAIS,iBAAiBP,uBAAuBM,aAAvB,CAArB;;AAEA,IAAIE,gBAAgBV,QAAQ,uBAAR,CAApB;;AAEA,IAAIW,iBAAiBT,uBAAuBQ,aAAvB,CAArB;;AAEA,SAASR,sBAAT,CAAgCU,GAAhC,EAAqC;AAAE,WAAOA,OAAOA,IAAIC,UAAX,GAAwBD,GAAxB,GAA8B,EAAEE,SAASF,GAAX,EAArC;AAAwD;;AAE/Ff,QAAQiB,OAAR,GAAkB,UAAUC,IAAV,EAAgB;AAC9B,QAAIC,SAASD,KAAKC,MAAlB;AAAA,QACIC,KAAKF,KAAKE,EADd;;AAGA,QAAIC,MAAM,CAAC,GAAGf,SAASgB,MAAb,GAAV;;AAEA;AACAD,QAAIE,IAAJ,CAAS,UAAT,EAAqB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACrCjB,sBAAcS,OAAd,CAAsBS,QAAtB,CAA+BF,IAAIG,MAAJ,CAAWC,EAA1C,EAA8C,UAAUC,GAAV,EAAeC,MAAf,EAAuB;AACjE,gBAAID,GAAJ,EAAS;AACLJ,oBAAIM,IAAJ,CAASF,GAAT;AACH;AACD,gBAAIG,aAAa,IAAIpB,eAAeK,OAAnB,EAAjB;AACAe,uBAAWC,SAAX,GAAuBT,IAAIU,IAAJ,CAASD,SAAhC;AACAD,uBAAWG,QAAX,GAAsBX,IAAIU,IAAJ,CAASC,QAA/B;AACAH,uBAAWI,GAAX,GAAiBA,IAAIC,GAArB;AACAL,uBAAWM,IAAX,CAAgB,UAAUT,GAAV,EAAeU,OAAf,EAAwB;AACpC,oBAAIV,GAAJ,EAAS;AACLJ,wBAAIM,IAAJ,CAASF,GAAT;AACH;AACDO,oBAAII,QAAJ,CAAaC,IAAb,CAAkBT,UAAlB;AACAI,oBAAIE,IAAJ,CAAS,UAAUT,GAAV,EAAe;AACpB,wBAAIA,GAAJ,EAAS;AACLJ,4BAAIM,IAAJ,CAASF,GAAT;AACH;AACJ,iBAJD;AAKAU,wBAAQD,IAAR,CAAa,UAAUT,GAAV,EAAe;AACxB,wBAAIA,GAAJ,EAAS;AACLJ,4BAAIM,IAAJ,CAASF,GAAT;AACH;AACDJ,wBAAIiB,IAAJ,CAAS,EAAEC,SAAS,mCAAX,EAAT;AACH,iBALD;AAMH,aAhBD;AAiBH,SAzBD;AA0BH,KA3BD;;AA6BA;AACAtB,QAAIuB,GAAJ,CAAQ,OAAR,EAAiB,UAAUpB,GAAV,EAAeC,GAAf,EAAoB;AACjCb,uBAAeK,OAAf,CAAuB4B,IAAvB,CAA4B,EAA5B,EAAgC,UAAUhB,GAAV,EAAeW,QAAf,EAAyB;AACrD,gBAAIX,GAAJ,EAAS;AACLJ,oBAAIM,IAAJ,CAASF,GAAT;AACH;AACDJ,gBAAIiB,IAAJ,CAASF,QAAT;AACH,SALD;AAMH,KAPD;;AASA;AACA;;;;;;;;;AASA;AACAnB,QAAIuB,GAAJ,CAAQ,GAAR,EAAa,UAAUpB,GAAV,EAAeC,GAAf,EAAoB;AAC7Bb,uBAAeK,OAAf,CAAuB4B,IAAvB,CAA4B,EAA5B,EAAgC,UAAUhB,GAAV,EAAeU,OAAf,EAAwB;AACpD,gBAAIV,GAAJ,EAAS;AACLJ,oBAAIM,IAAJ,CAASF,GAAT;AACH;AACDJ,gBAAIiB,IAAJ,CAASH,OAAT;AACH,SALD;AAMH,KAPD;;AASA;AACAlB,QAAIyB,GAAJ,CAAQ,aAAR,EAAuB,UAAUtB,GAAV,EAAeC,GAAf,EAAoB;AACvCb,uBAAeK,OAAf,CAAuBS,QAAvB,CAAgCF,IAAIG,MAAJ,CAAWC,EAA3C,EAA+C,UAAUC,GAAV,EAAeU,OAAf,EAAwB;AACnE,gBAAIV,GAAJ,EAAS;AACLJ,oBAAIM,IAAJ,CAASF,GAAT;AACH;AACD,gBAAIL,IAAIU,IAAJ,CAASD,SAAT,KAAuBc,SAA3B,EAAsC;AAClCR,wBAAQN,SAAR,GAAoBT,IAAIU,IAAJ,CAASD,SAA7B;AACH;AACD,gBAAIT,IAAIU,IAAJ,CAASC,QAAT,KAAsBY,SAA1B,EAAqC;AACjCR,wBAAQJ,QAAR,GAAmBX,IAAIU,IAAJ,CAASC,QAA5B;AACH;AACDI,oBAAQD,IAAR,CAAa,UAAUT,GAAV,EAAe;AACxB,oBAAIA,GAAJ,EAAS;AACLJ,wBAAIM,IAAJ,CAASF,GAAT;AACH;AACDJ,oBAAIiB,IAAJ,CAAS,EAAEC,SAASJ,QAAQN,SAAR,GAAoB,GAApB,GAA0BM,QAAQJ,QAAlC,GAA6C,+BAAxD,EAAT;AACH,aALD;AAMH,SAhBD;AAiBH,KAlBD;;AAoBA;AACAd,QAAI2B,MAAJ,CAAW,aAAX,EAA0B,UAAUxB,GAAV,EAAeC,GAAf,EAAoB;AAC1Cb,uBAAeK,OAAf,CAAuBS,QAAvB,CAAgCF,IAAIG,MAAJ,CAAWC,EAA3C,EAA+C,UAAUC,GAAV,EAAeU,OAAf,EAAwB;AACnE,gBAAIV,GAAJ,EAAS;AACLJ,oBAAIM,IAAJ,CAASF,GAAT;AACH;AACD,gBAAID,KAAKW,QAAQU,UAAjB;AACAvC,6BAAiBO,OAAjB,CAAyBS,QAAzB,CAAkCE,EAAlC,EAAsC,UAAUC,GAAV,EAAeqB,SAAf,EAA0B;AAC5DA,0BAAUV,QAAV,CAAmBW,IAAnB,CAAwBZ,OAAxB;AACAW,0BAAUZ,IAAV,CAAe,UAAUT,GAAV,EAAe;AAC1B,wBAAIA,GAAJ,EAAS;AACLJ,4BAAIM,IAAJ,CAASF,GAAT;AACH;AACDjB,mCAAeK,OAAf,CAAuBmC,MAAvB,CAA8B;AAC1Bf,6BAAKb,IAAIG,MAAJ,CAAWC;AADU,qBAA9B,EAEG,UAAUC,GAAV,EAAeU,OAAf,EAAwB;AACvB,4BAAIV,GAAJ,EAAS;AACLJ,gCAAIM,IAAJ,CAASF,GAAT;AACH;AACDJ,4BAAIiB,IAAJ,CAAS,EAAEC,SAAS,8BAAX,EAAT;AACH,qBAPD;AAQH,iBAZD;AAaH,aAfD;AAgBH,SArBD;AAsBH,KAvBD;;AAyBA,WAAOtB,GAAP;AACH,CAlHD;AAmHA","file":"teacherController.js","sourcesContent":["'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _mongoose = require('mongoose');\r\n\r\nvar _mongoose2 = _interopRequireDefault(_mongoose);\r\n\r\nvar _express = require('express');\r\n\r\nvar _schoolModel = require('../model/schoolModel');\r\n\r\nvar _schoolModel2 = _interopRequireDefault(_schoolModel);\r\n\r\nvar _classroomModel = require('../model/classroomModel');\r\n\r\nvar _classroomModel2 = _interopRequireDefault(_classroomModel);\r\n\r\nvar _teacherModel = require('../model/teacherModel');\r\n\r\nvar _teacherModel2 = _interopRequireDefault(_teacherModel);\r\n\r\nvar _studentModel = require('../model/studentModel');\r\n\r\nvar _studentModel2 = _interopRequireDefault(_studentModel);\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nexports.default = function (_ref) {\r\n    var config = _ref.config,\r\n        db = _ref.db;\r\n\r\n    var api = (0, _express.Router)();\r\n\r\n    // '/classroom/teachers/add/:id' - Create new teachers\r\n    api.post('/add/:id', function (req, res) {\r\n        _schoolModel2.default.findById(req.params.id, function (err, school) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            var newTeacher = new _teacherModel2.default();\r\n            newTeacher.firstName = req.body.firstName;\r\n            newTeacher.lastName = req.body.lastName;\r\n            newTeacher.hub = hub._id;\r\n            newTeacher.save(function (err, teacher) {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n                hub.teachers.push(newTeacher);\r\n                hub.save(function (err) {\r\n                    if (err) {\r\n                        res.send(err);\r\n                    }\r\n                });\r\n                teacher.save(function (err) {\r\n                    if (err) {\r\n                        res.send(err);\r\n                    }\r\n                    res.json({ message: 'Teacher successfully added to hub' });\r\n                });\r\n            });\r\n        });\r\n    });\r\n\r\n    // '/classroom/teachers/list' - Read all teachers\r\n    api.get('/list', function (req, res) {\r\n        _teacherModel2.default.find({}, function (err, teachers) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json(teachers);\r\n        });\r\n    });\r\n\r\n    // '/classroom/teachers/:classId' - Read all teachers by classId\r\n    /*api.get('/:classId', (req, res) => {\r\n        Teacher.find({classrooms: req.params.classId}, (err, teachers) => {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json(teachers);\r\n        });\r\n    });*/\r\n\r\n    // '/classroom/teachers/:id' - Read teacher by id\r\n    api.get('/', function (req, res) {\r\n        _teacherModel2.default.find({}, function (err, teacher) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json(teacher);\r\n        });\r\n    });\r\n\r\n    // '/classroom/teachers/update/:id' - Update\r\n    api.put('/update/:id', function (req, res) {\r\n        _teacherModel2.default.findById(req.params.id, function (err, teacher) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            if (req.body.firstName !== undefined) {\r\n                teacher.firstName = req.body.firstName;\r\n            }\r\n            if (req.body.lastName !== undefined) {\r\n                teacher.lastName = req.body.lastName;\r\n            }\r\n            teacher.save(function (err) {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n                res.json({ message: teacher.firstName + ' ' + teacher.lastName + '\\'s info updated successfully' });\r\n            });\r\n        });\r\n    });\r\n\r\n    // '/classroom/teachers/remove/:id' - Delete\r\n    api.delete('/remove/:id', function (req, res) {\r\n        _teacherModel2.default.findById(req.params.id, function (err, teacher) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            var id = teacher.classrooms;\r\n            _classroomModel2.default.findById(id, function (err, classroom) {\r\n                classroom.teachers.pull(teacher);\r\n                classroom.save(function (err) {\r\n                    if (err) {\r\n                        res.send(err);\r\n                    }\r\n                    _teacherModel2.default.remove({\r\n                        _id: req.params.id\r\n                    }, function (err, teacher) {\r\n                        if (err) {\r\n                            res.send(err);\r\n                        }\r\n                        res.json({ message: 'Teacher successfully removed' });\r\n                    });\r\n                });\r\n            });\r\n        });\r\n    });\r\n\r\n    return api;\r\n};\r\n//# sourceMappingURL=teacher.js.map"]}