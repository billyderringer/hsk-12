{"version":3,"sources":["../../src/controller/hub.js"],"names":["config","db","api","post","req","res","newHub","hubName","body","save","err","send","json","message","get","find","hub","findById","params","hubId","put","delete","remove","_id","deletedHub","id","homerooms","teachers","students"],"mappings":"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","file":"hub.js","sourcesContent":["import mongoose from 'mongoose';\r\nimport {Router} from 'express';\r\nimport Hub from '../model/hub';\r\nimport Homeroom from '../model/homeroom';\r\nimport Teacher from '../model/teacher';\r\nimport Student from '../model/student';\r\n\r\nexport default ({config, db}) => {\r\n    const api = Router();\r\n\r\n    // '/hub/' - Create new hub\r\n    api.post('/create', (req, res) => {\r\n        let newHub = new Hub();\r\n        newHub.hubName = req.body.hubName;\r\n        newHub.save(err => {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json({message: newHub.hubName + ' has been created successfully'});\r\n        });\r\n    });\r\n\r\n    // '/hub/' - Read all hubs\r\n    api.get('/', (req, res) => {\r\n        Hub.find({}, (err, hub) => {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json(hub);\r\n        });\r\n    });\r\n\r\n    // '/hub/:hubId' - Read hub by hubId\r\n    api.get('/:hubId', (req, res) => {\r\n        Hub.findById(req.params.hubId, (err, hub) => {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json(hub);\r\n        });\r\n    });\r\n\r\n    // '/hub/:hubId' - Update\r\n    api.put('/update/:hubId', (req, res) => {\r\n        Hub.findById(req.params.hubId, (err, hub) => {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            hub.hubName = req.body.hubName;\r\n            hub.save(err => {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n                res.json({message: hub.hubName + ' info updated'});\r\n            });\r\n        });\r\n    });\r\n\r\n    // '/hub/:hubId' - Delete\r\n    api.delete('/remove/:hubId', (req, res) => {\r\n        Hub.remove({_id: req.params.hubId}, (err, deletedHub) => {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            let id = deletedHub.homerooms;\r\n            Homeroom.remove(id, err => {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n            });\r\n            id = deletedHub.teachers;\r\n            Teacher.remove(id, err => {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n            });\r\n            id = deletedHub.students;\r\n            Student.remove(id, err => {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n            });\r\n            res.json({message: \"Hub successfully removed\"});\r\n        });\r\n    });\r\n\r\n    return api;\r\n}"]}