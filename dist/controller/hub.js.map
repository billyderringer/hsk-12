{"version":3,"sources":["hub.js"],"names":["Object","defineProperty","exports","value","_mongoose","require","_mongoose2","_interopRequireDefault","_express","_hub","_hub2","_homeroom","_homeroom2","_teacher","_teacher2","_student","_student2","obj","__esModule","default","_ref","config","db","api","Router","post","req","res","newHub","hubName","body","save","err","send","json","message","get","find","hub","findById","params","hubId","put","delete","remove","_id","deletedHub","id","homerooms","teachers","students"],"mappings":"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","file":"hub.js","sourcesContent":["'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _mongoose = require('mongoose');\r\n\r\nvar _mongoose2 = _interopRequireDefault(_mongoose);\r\n\r\nvar _express = require('express');\r\n\r\nvar _hub = require('../model/hub');\r\n\r\nvar _hub2 = _interopRequireDefault(_hub);\r\n\r\nvar _homeroom = require('../model/homeroom');\r\n\r\nvar _homeroom2 = _interopRequireDefault(_homeroom);\r\n\r\nvar _teacher = require('../model/teacher');\r\n\r\nvar _teacher2 = _interopRequireDefault(_teacher);\r\n\r\nvar _student = require('../model/student');\r\n\r\nvar _student2 = _interopRequireDefault(_student);\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nexports.default = function (_ref) {\r\n    var config = _ref.config,\r\n        db = _ref.db;\r\n\r\n    var api = (0, _express.Router)();\r\n\r\n    // '/hub/create' - Create new hub\r\n    api.post('/create', function (req, res) {\r\n        var newHub = new _hub2.default();\r\n        newHub.hubName = req.body.hubName;\r\n        newHub.save(function (err) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json({ message: newHub.hubName + ' has been created successfully' });\r\n        });\r\n    });\r\n\r\n    // '/hub/' - Read all hubs\r\n    api.get('/', function (req, res) {\r\n        _hub2.default.find({}, function (err, hub) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json(hub);\r\n        });\r\n    });\r\n\r\n    // '/hub/:hubId' - Read hub by hubId\r\n    api.get('/:hubId', function (req, res) {\r\n        _hub2.default.findById(req.params.hubId, function (err, hub) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json(hub);\r\n        });\r\n    });\r\n\r\n    // '/hub/:hubId' - Update\r\n    api.put('/update/:hubId', function (req, res) {\r\n        _hub2.default.findById(req.params.hubId, function (err, hub) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            hub.hubName = req.body.hubName;\r\n            hub.save(function (err) {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n                res.json({ message: hub.hubName + ' info updated' });\r\n            });\r\n        });\r\n    });\r\n\r\n    // '/hub/:hubId' - Delete\r\n    api.delete('/remove/:hubId', function (req, res) {\r\n        _hub2.default.remove({ _id: req.params.hubId }, function (err, deletedHub) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            var id = deletedHub.homerooms;\r\n            _homeroom2.default.remove(id, function (err) {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n            });\r\n            id = deletedHub.teachers;\r\n            _teacher2.default.remove(id, function (err) {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n            });\r\n            id = deletedHub.students;\r\n            _student2.default.remove(id, function (err) {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n            });\r\n            res.json({ message: \"Hub successfully removed\" });\r\n        });\r\n    });\r\n\r\n    return api;\r\n};\r\n//# sourceMappingURL=hub.js.map"]}