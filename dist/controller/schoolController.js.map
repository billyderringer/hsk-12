{"version":3,"sources":["schoolController.js"],"names":["Object","defineProperty","exports","value","_mongoose","require","_mongoose2","_interopRequireDefault","_express","_schoolModel","_schoolModel2","_classroomModel","_classroomModel2","_teacherModel","_teacherModel2","_studentModel","_studentModel2","obj","__esModule","default","_ref","config","db","api","Router","post","req","res","newHub","hubName","body","save","err","send","json","message","get","find","hub","findById","params","schoolId","school","teachers","students","put","roomName","delete","remove","_id","id","deletedHub","idClassRooms","classrooms","idTeachers","idStudents"],"mappings":"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","file":"schoolController.js","sourcesContent":["'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _mongoose = require('mongoose');\r\n\r\nvar _mongoose2 = _interopRequireDefault(_mongoose);\r\n\r\nvar _express = require('express');\r\n\r\nvar _schoolModel = require('../model/schoolModel');\r\n\r\nvar _schoolModel2 = _interopRequireDefault(_schoolModel);\r\n\r\nvar _classroomModel = require('../model/classroomModel');\r\n\r\nvar _classroomModel2 = _interopRequireDefault(_classroomModel);\r\n\r\nvar _teacherModel = require('../model/teacherModel');\r\n\r\nvar _teacherModel2 = _interopRequireDefault(_teacherModel);\r\n\r\nvar _studentModel = require('../model/studentModel');\r\n\r\nvar _studentModel2 = _interopRequireDefault(_studentModel);\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nexports.default = function (_ref) {\r\n    var config = _ref.config,\r\n        db = _ref.db;\r\n\r\n    var api = (0, _express.Router)();\r\n\r\n    // '/hub/add' - Create new hub\r\n    api.post('/add', function (req, res) {\r\n        var newHub = new _schoolModel2.default();\r\n        newHub.hubName = req.body.hubName;\r\n        newHub.save(function (err) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json({ message: newHub.hubName + ' has been created successfully' });\r\n        });\r\n    });\r\n\r\n    // '/hub' - Read all schools\r\n    api.get('/', function (req, res) {\r\n        _schoolModel2.default.find({}, function (err, hub) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json(hub);\r\n        });\r\n    });\r\n\r\n    // '/hub/teachers/:schoolId' - Read all teachers\r\n    api.get('/teachers/:schoolId', function (req, res) {\r\n        _schoolModel2.default.findById(req.params.schoolId, function (err, school) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json(hub.teachers);\r\n        });\r\n    });\r\n\r\n    // '/hub/students/:schoolId' - Read all students\r\n    api.get('/students/:schoolId', function (req, res) {\r\n        _schoolModel2.default.findById(req.params.schoolId, function (err, school) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json(hub.students);\r\n        });\r\n    });\r\n\r\n    // '/hub/update' - Update\r\n    api.put('/update', function (req, res) {\r\n        _schoolModel2.default.find({}, function (err, hub) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            hub.hubName = req.body.roomName;\r\n            hub.save(function (err) {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n                res.json({ message: hub.hubName + ' info updated' });\r\n            });\r\n        });\r\n    });\r\n\r\n    // '/hub/remove' - Delete\r\n    api.delete('/remove/:id', function (req, res) {\r\n        _schoolModel2.default.remove({ _id: req.params.id }, function (err, deletedHub) {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            var idClassRooms = deletedHub.classrooms;\r\n            var idTeachers = deletedHub.teachers;\r\n            var idStudents = deletedHub.students;\r\n            _classroomModel2.default.remove(idClassRooms, function (err, classrooms) {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n            });\r\n            _teacherModel2.default.remove(idTeachers, function (err, teachers) {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n            });\r\n            _studentModel2.default.remove(idStudents, function (err, students) {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n            });\r\n            res.json({ message: \"Homeroom successfully removed\" });\r\n        });\r\n    });\r\n\r\n    return api;\r\n};\r\n//# sourceMappingURL=hub.js.map"]}